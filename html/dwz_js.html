<?cs if:config.notify_daemon ?>
<script language="javascript" src="<?cs var:config.docpath?>js/dmt_xrkmonitor.js"></script>
<?cs /if ?>

<?cs if:config.xrkmonitor_debug==1 ?>
<script src="<?cs var:config.docpath?>js/dmt.comm.js" type="text/javascript"></script>
<script src="<?cs var:config.docpath?>resource/js/jquery-1.9.1.min.js"></script>
<script src="<?cs var:config.docpath?>resource/js/jquery.cookie.js"></script>
<script src="<?cs var:config.docpath?>resource/js/jquery.validate.js"></script>
<script src="<?cs var:config.docpath?>resource/js/jquery.bgiframe.js"></script>
<script src="<?cs var:config.docpath?>resource/js/dwz.min.js?1"></script>
<script src="<?cs var:config.docpath?>js/dwz.regional.zh.js" type="text/javascript"></script>
<script src="<?cs var:config.docpath?>js/echarts.min.js"></script>
<script src="<?cs var:config.docpath?>js/china.js"></script>
<?cs else ?>
<script src="<?cs var:config.docpath?>js/dmt.comm.min.js?v=20200509" type="text/javascript"></script>
<script src="<?cs var:config.docpath?>js/jquery.min.js?v=2020506"></script>
<script src="<?cs var:config.docpath?>js/jquery.other.min.js?v=2020506"></script>
<script src="<?cs var:config.docpath?>js/dwz.all.min.js?v=2020506"></script>
<script src="<?cs var:config.docpath?>js/echarts.min.js?v=2020506"></script>
<script src="<?cs var:config.docpath?>js/china.min.js?v=2020506"></script>
<?cs /if ?>

<script type="text/javascript">

var g_di_cspath = '<?cs var:config.cspath ?>';
var g_di_docpath = '<?cs var:config.docpath ?>';
var g_di_cgipath = '<?cs var:config.cgipath?>';

/* localStorage 浏览器兼容问题 fix */
if (!window.localStorage) {
  window.localStorage = {
    getItem: function (sKey) {
      if (!sKey || !this.hasOwnProperty(sKey)) { return null; }
      return unescape(document.cookie.replace(new RegExp("(?:^|.*;\\s*)" 
		+ escape(sKey).replace(/[\-\.\+\*]/g, "\\$&") + "\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*"), "$1"));
    },
    key: function (nKeyId) {
      return unescape(document.cookie.replace(/\s*\=(?:.(?!;))*$/, "").split(/\s*\=(?:[^;](?!;))*[^;]?;\s*/)[nKeyId]);
    },
    setItem: function (sKey, sValue) {
      if(!sKey) { return; }
      document.cookie = escape(sKey) + "=" + escape(sValue) + "; expires=Tue, 19 Jan 2038 03:14:07 GMT; path=/";
      this.length = document.cookie.match(/\=/g).length;
    },
    length: 0,
    removeItem: function (sKey) {
      if (!sKey || !this.hasOwnProperty(sKey)) { return; }
      document.cookie = escape(sKey) + "=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/";
      this.length--;
    },
    hasOwnProperty: function (sKey) {
      return (new RegExp("(?:^|;\\s*)" + escape(sKey).replace(/[\-\.\+\*]/g, "\\$&") + "\\s*\\=")).test(document.cookie);
    }
  };
  window.localStorage.length = (document.cookie.match(/\=/g) || window.localStorage).length;
}

function djOnReadyOk()
{
	// 主页相关逻辑
	dcOnMainPage();
	dcInitMainPage();
	dcRefreshStatInfo();
	setTimeout(function(){ $('#navMenuLast a').click(); }, 100);
}

$(document).ready(function(){
	DWZ.init("<?cs var:config.docpath?>resource/dwz.frag.html", {
		statusCode:{ok:200, error:300, timeout:301}, //【可选】
		pageInfo:{pageNum:"pageNum", numPerPage:"numPerPage", orderField:"orderField", orderDirection:"orderDirection"}, //【可选】
		debug:false,	// 调试模式 【true|false】
		callback:function(){
			initEnv();

			// global info for javascript use
			g_siteInfo = $.parseJSON('<?cs var:config.site_info ?>');
			$("#themeList").theme({themeBase:"<?cs var:config.docpath?>resource/themes",defaultTheme:"toptry"});

			$("#a_logout").click(function(){
				var d = new Date();
				var url = g_siteInfo.cgi_path+"slog_flogin?action=logout&v="+d.getTime();
				location.replace(url);
				return false;
			});

			$("#a_relogin").click(function(){
				var url = g_siteInfo.cgi_path+"slog_flogin?action=relogin&redirect_url=";
				url += encodeURIComponent(window.location);
				url += "&user_id=<?cs var:comm.user_id ?>";
				location.replace(url);
				return false;
			});

			if(<?cs var:config.check_lv2_vcode ?>+0 == 1) {
				djLv2CheckPopDlg();
				return ;
			}

			djOnReadyOk();
		}
	});
});

</script>

