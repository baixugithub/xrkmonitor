var g_dmtChartWidth,g_dmtLastLeftShow=null,g_dmtLastType=null,g_dmtLastTypeId=null,g_dmtChartMargin=20,g_dmtChartMinWidth=560,g_dmtChartHeight=460,g_dmtSingleChartMinWidth=1100,g_dmtSingleChartHeight=520,g_all_charts=new Array,g_dmtRedrawChartCountShowProc=5,g_PluginMargin=10;function dmtMathtrunc(t){return"function"!=typeof Math.trunc?Math.round(t):Math.trunc(t)}function dmtGetHumanTime(t){var e="";return 86400<=t&&(e+=dmtMathtrunc(t/86400)+"天 ",t%=86400),3600<=t&&(e+=dmtMathtrunc(t/3600)+"小时 ",t%=3600),60<=t&&(e+=dmtMathtrunc(t/60)+"分钟 ",t%=60),1<=t&&(e+=dmtMathtrunc(t)+"秒 "),e}function dmtSetPluginMarginInfo(t){var e=DWZ.ui.sbar?$("#sidebar").width()+10:24,a=$(window).width()-e-20-45,i=a%452,r=dmtMathtrunc(a/452),n=dmtMathtrunc(i/r/2);if(n==g_PluginMargin)return!1;if(g_PluginMargin=n,void 0===t)return!0;return"dmt_plugin_open"!=t?dmtJsBugReport("dmt.comm.js","dmtSetPluginMarginInfo","unknow plugin tab:"+t):$("#dpopen_plugin_list").children().each(function(){$(this).css("margin","10px "+g_PluginMargin+"px")}),!0}function dmtIsExplorerSupport(){return!0}function dmtGetCookie(t){var e=document.cookie.match(new RegExp("(^| )"+t+"=([^;]*)(;|$)"));return null!=e?unescape(e[2]):null}function dmtDelCookie(t){var e=new Date(new Date-6048e5),a=dmtGetCookie(t);null!=a&&(document.cookie=t+"="+a+"; expires="+e.toUTCString()+";path=/")}function dmtSetChartSize(){var t=DWZ.ui.sbar?$("#sidebar").width()+10:24,e=$(window).width()-t-5-45;void 0!==g_dmtLastLeftShow&&g_dmtLastLeftShow&&(e-=$(".chartLeftMenu").width());var a=g_dmtChartMinWidth+2*g_dmtChartMargin,i=e%a,r=dmtMathtrunc(e/a),n=dmtMathtrunc(i/r);g_dmtChartWidth=g_dmtChartMinWidth+n}function dmtSetRedrawChartsInfo(t,e,a){g_dmtLastTypeId=t,g_dmtLastType=e,g_dmtLastLeftShow=a}function dmtRedrawCharts(t,e,a){if(void 0!==t?(g_dmtLastTypeId=t,g_dmtLastType=e,g_dmtLastLeftShow=a):(t=g_dmtLastTypeId,e=g_dmtLastType,a=g_dmtLastLeftShow),null!=t&&(dmtSetChartSize(),void 0!==g_all_charts)){var i="_"+t+e,r=0;for(ct in g_all_charts)if(ct.match(i)){if(void 0!==g_all_charts[ct].setwidth&&g_all_charts[ct].setwidth==g_dmtChartWidth)return;r++}var n=$("#my_background,#my_progressBar");g_dmtRedrawChartCountShowProc<r&&($("#my_progressBar").text("图表重绘中, 请稍等..."),n.show()),setTimeout(function(){for(ct in g_all_charts)ct.match(i)&&($("#"+ct).css("width",g_dmtChartWidth),g_all_charts[ct].resize(),g_all_charts[ct].setwidth=g_dmtChartWidth);n.hide()},5)}}function dmtMaskWarnConfig(t,e,a){var n,i,r={},o="attr_"+a+"_"+e+t;void 0!==g_all_charts[o]&&void 0!==g_all_charts[o].warnInfo?(n=g_all_charts[o].warnInfo,r.action="mask_warn_config",r.mask=n.mask,r.warn_cfg_id=n.warn_cfg_id,i=(void 0!==g_siteInfo.cgi_path&&""!=g_siteInfo.cgi_path?g_siteInfo.cgi_path:n.cgi_path)+"mt_slog_warn",$.ajax({url:i,data:r,global:!1,success:function(t){var e,a,i,r;dmtFirstDealAjaxResponse(t)||(200==t.statusCode?(a=(e=g_all_charts[o]).getOption().title[0].subtext.split("\n")[0],a+="\n 告警配置【 最大值：",i="","percent"==n.show_class&&(i="%"),1&t.warn_flag?a+=t.warn_max+i:a+="无 ",a+="，最小值：",2&t.warn_flag?a+=t.warn_min+i:a+="无 ",a+="，波动值：",4&t.warn_flag?a+=t.warn_wave+"% ":a+="无 ",32&t.warn_flag&&(a+="，屏蔽状态：已屏蔽"),r={title:{subtext:a+=" 】"},toolbox:{feature:{myUnMaskWarningData:{show:!0},myMaskWarningData:{show:!0},mySetWarningData:{show:!0}}}},n.warn_cfg_id=t.warn_config_id,32&t.warn_flag?(r.toolbox.feature.myUnMaskWarningData.show=!0,r.toolbox.feature.mySetWarningData.show=!1,r.toolbox.feature.myMaskWarningData.show=!1,n.mask=0):(r.toolbox.feature.myUnMaskWarningData.show=!1,r.toolbox.feature.mySetWarningData.show=!0,1&t.warn_flag||2&t.warn_flag||4&t.warn_flag?(r.toolbox.feature.mySetWarningData.show=!0,n.mask=1):(r.toolbox.feature.mySetWarningData.show=!1,n.mask=0)),e.setOption(r)):alertMsg.warn(DWZ.msg(t.msgid)))},dataType:"json"})):alertMsg.error("javascript 脚本错误, 无告警信息:"+o)}function dmtSetWarnConfig(t,e,a){var i,r,n,o,s,l,d="attr_"+a+"_"+e+t;void 0!==g_all_charts[d]&&void 0!==g_all_charts[d].warnInfo?(i=g_all_charts[d].warnInfo,r=(void 0!==g_siteInfo.cgi_path&&""!=g_siteInfo.cgi_path?g_siteInfo.cgi_path:i.cgi_path)+"/mt_slog_warn?action=chart_set_attr_warn",n=i.attr_name,r+="&warn_cfg_id="+i.warn_cfg_id,r+="&show_class="+i.show_class,r+="&attr_name="+n,r+="&warn_type_id="+e,r+="&warn_attr_id="+a,r+="&warn_type="+t,o="dc_dlg_set_warn_"+e+"_"+a,s=$.parseJSON('{"mask":true,"maxable":false,"height":260,"width":530,"resizable":false}'),l="",l="view"==t?"设置视图告警：视图【"+e+"】监控点【"+a+"_"+n+"】":"设置服务器告警：服务器【"+e+"】监控点【"+a+"_"+n+"】",$.pdialog.open(r,o,l,s)):alertMsg.error("javascript 脚本错误, 无告警信息:"+d)}function dmtShowSingle(t,e,a,i,r,n,o,s){var l=i+"/mt_slog_showview?action=show_single";l+="&type_id="+n,l+="&cust_date="+t,l+="&show_type="+r,l+="&attr_id="+o,l+="&show_single_type="+a;var d="dc_dlg_show_single_"+n+"_"+o,_='{"mask":true,"maxable":false,"height":';_+=g_dmtSingleChartHeight,_+=',"width":'+g_dmtSingleChartMinWidth+',"resizable":true}';var c=$.parseJSON(_),g="",g="view"==r?"视图【"+n+"】监控点【"+o+"_"+e+"】":"machine"==r?"服务器【"+n+"】监控点【"+o+"_"+e+"】":"监控网点【"+o+"_"+e+"】 站点链接："+s;g+=" - 上报数据查看",$.pdialog.open(l,d,g,c)}function dmtSetShowSingleSite(t,e,a,i,r){t.toolbox.feature.myShowSingleData.onclick=function(){return dmtShowSingle(a.cust_date,r.name,a.show_single_type,a.cgi_path,e,a.site_id,r.id,a.site_url)}}function dmtGetDateStr(t,e){var a=new Date(t+60*(new Date).getTimezoneOffset()*1e3),i="";return void 0===e&&(i=a.getFullYear(),a.getMonth()<9?i+="-0"+(a.getMonth()+1):i+="-"+(a.getMonth()+1),a.getDate()<10?i+="-0"+a.getDate():i+="-"+a.getDate()),a.getHours()<10?i+=" 0"+a.getHours():i+=" "+a.getHours(),a.getMinutes()<10?i+=":0"+a.getMinutes():i+=":"+a.getMinutes(),i}function dmtSetCustToolBox(t,e,a,i,r,n){var o="view"==e?(t.toolbox.feature.myShowSingleData.onclick=function(){return dmtShowSingle(a.cust_date,r.name,a.show_single_type,a.cgi_path,e,a.view_id,r.id)},a.view_id):(t.toolbox.feature.myShowSingleData.onclick=function(){return dmtShowSingle(a.cust_date,r.name,a.show_single_type,a.cgi_path,e,a.machine_id,r.id)},a.machine_id);24&i.warn_flag?n.warn_cfg_id=i.warn_config_id:n.warn_cfg_id=0,void 0!==g_siteInfo.cgi_path&&""==g_siteInfo.cgi_path||(n.cgi_path=a.cgi_path),n.show_class=r.show_class,n.attr_name=r.name,32&i.warn_flag?(t.toolbox.feature.myUnMaskWarningData.show=!0,t.toolbox.feature.mySetWarningData.show=!1,t.toolbox.feature.myMaskWarningData.show=!1,n.mask=0):(t.toolbox.feature.myUnMaskWarningData.show=!1,t.toolbox.feature.mySetWarningData.show=!0,1&i.warn_flag||2&i.warn_flag||4&i.warn_flag?(t.toolbox.feature.myMaskWarningData.show=!0,n.mask=1):(t.toolbox.feature.myMaskWarningData.show=!1,n.mask=0)),t.toolbox.feature.myUnMaskWarningData.onclick=function(){return dmtMaskWarnConfig(e,o,r.id)},t.toolbox.feature.mySetWarningData.onclick=function(){return dmtSetWarnConfig(e,o,r.id)},t.toolbox.feature.myMaskWarningData.onclick=function(){return dmtMaskWarnConfig(e,o,r.id)}}function dmtGetViewSubTitle(t,e,a,i){var r="";0<a.max?(r=" 上报信息【",r+="最大值："+dmtShowChangeValue(a.max),r+=" 当前时间："+e.date_time+" 上报值：",r+=dmtShowChangeValue(a.cur)+"】\n "):r="暂无数据上报\n\n",r+="告警配置【 最大值：";var n="";return"percent"==i.show_class&&(n="%"),1&a.warn_flag?r+=a.warn_max+n:r+="无 ",r+="，最小值：",2&a.warn_flag?r+=a.warn_min+n:r+="无 ",r+="，波动值：",4&a.warn_flag?r+=a.warn_wave+"% ":r+="无 ",32&a.warn_flag&&(r+="，屏蔽状态：已屏蔽"),r+=" 】"}function dmtGetViewTitle(t,e,a){var i;return"view"==t?(i="视图ID【"+e.view_id+"】",i+="监控点【"+a.name+"-"+a.id+"】"):"machine"==t&&(i="服务器ID【"+e.machine_id+"】",i+="监控点【"+a.name+"-"+a.id+"】"),i}function dmtGetTimeStamp(t){if(void 0===t||""==t)return 0;var e=t.split(" "),a=e[0].split("-"),i=+a[0],r=+a[1],n=+a[2],o=+(a=e[1].split(":"))[0],s=+a[1],l=+a[2];return new Date(i,r-1,n,o,s,l)/1e3}function dmtEncodeHTML(t){return 0===t.length?"":t.replace(/&#39;/g,"'").replace(/&#160;/g," ").replace(/&#92;/g,"\\").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/_r_n/g,"<br>").replace(/\\x0A/g,"<br>").replace(/\\x2F/g,"/").replace(/\\x3B/g,";").replace(/\\x22/g,'"').replace(/\\x3C/g,"<").replace(/\\x26/g,"&").replace(/\\x27/g,"'").replace(/\\x5C/g,"\\").replace(/\\x3E/g,">")}function dmtJsBugReport(t,e,a){}function dmtExport(t,e){alertMsg.confirm("确实要导出这些记录吗?",{okCall:function(){$.ajax({type:"post",url:t,data:{data:e},dataType:"json",global:!1,cache:!1,success:function(t){0!=t.statusCode?alertMsg.warn(t.msg):0==t.record_count?alertMsg.info("记录为空"):window.location=t.file},error:DWZ.ajaxError})}})}function dmtSetTypeTree(t){var e="<li><a href='#' name="+t.type+">"+t.name+"</a>";if(0==t.subcount)return e+="</li>";e+="<ul>";for(var a=t.list,i=0;i<t.subcount&&i<a.length;i++)e+=dmtSetTypeTree(a[i]);return e+="</ul>",e+="</li>"}function dmtGetTypeInfo(t,e){if(t.type==e)return t;for(var a=t.list,i=0;i<t.subcount&&i<a.length;i++){var r=dmtGetTypeInfo(a[i],e);if("null"!=r)return r}return"null"}function dmtGetAttrInfo(t,e){for(var a=t.list,i=0;i<t.count&&i<a.length;i++)if(a[i].id==e)return a[i];return"null"}function dmtJumpToAttrPic(t,e,a){var i="#"+t;if($(i).length<=0){var r=t.split("_");return"click"!=a&&$.isFunction(a)?(0==a(t)?alertMsg.info("监控点:"+r[1]+" 无数据上报"):alertMsg.info("监控点:"+r[1]+" 上报数据获取中..."),!1):(alertMsg.info("监控点:"+r[1]+" 无数据上报"),!1)}var n=$(e).scrollTop(),o=$(e).offset().top,s=$(i).offset().top-o+n;return $(e).animate({scrollTop:s}),!1}function dmtSetAttrList(t,e,a,i,r){var n,o=t.list,s="<li>",l="view"==a?(s+="<a href='#'>视图【"+t.view_id+"】已绑定的监控点列表",n="#ds_ct_attr_show_list_"+t.view_id,t.view_id):(s+="<a href='#'>机器【"+t.machine_id+"】有上报的监控点列表",n="#dsm_ct_attr_show_list_"+t.machine_id,t.machine_id);s+="(共:"+t.count+"个)</a>";for(var d=0;d<t.count&&d<o.length;d++)o[d].pushed=!1;for(d=0;d<t.count&&d<o.length;d++)if(!o[d].pushed){"site"!=a&&(s+="<ul>",s+="<li><a href='#'>"+e[o[d].attr_type]+"</a>"),s+="<ul>";for(var _,c=d;c<t.count&&c<o.length;c++){o[c].pushed||o[c].attr_type!=o[d].attr_type||(o[c].pushed=!0,s+="<li>",s+="<a onclick=\"dmtJumpToAttrPic('"+(_="attr_"+o[c].id+"_"+l+a)+"', '"+n+"', "+r+")\" href='#' ctid='"+_+"'>",s+=o[c].id+"_"+o[c].name,1==o[c].global&&(s+="<font color='blue'>&nbsp;[全局]</font>"),i.push(o[c].id),s+="</a>",s+="</li>")}s+="</ul>",s+="</li>",s+="</ul>"}return s+="</li>"}function dmtShowChangeValue(t){if(1073741824<=t){var e=t/1073741824;return Math.round(100*parseFloat(e))/100+"G"}if(1048576<=t){e=t/1048576;return Math.round(100*parseFloat(e))/100+"M"}if(1024<=t){e=t/1024;return Math.round(100*parseFloat(e))/100+"K"}return t}function dmtSetStrAttrInfoChartIpGeo(t,e,a,i,r){var n={title:{x:"left",subtext:"",top:"top",subtextStyle:{},show:!0,text:""},tooltip:{trigger:"item",confine:!0,formatter:"{b}<br/>访问次数: {c}"},visualMap:{min:0,max:1e4,realtime:!0,calculable:!0,inRange:{color:["lightskyblue","yellow","orangered"]}},toolbox:{show:!0,orient:"vertical",top:"center",right:20,feature:{dataView:{readOnly:!1},restore:{},saveAsImage:{}}},legend:{type:"scroll",orient:"vertical",left:"left",top:"70",show:!0},series:[{type:"map",mapType:"china",label:{show:!0},data:[],geoIndex:0}]};if($("#"+t).css("height",g_dmtChartHeight),n.title.text="view"==r?"视图ID【"+i.view_id+"】监控点："+e.name:"服务器ID【"+i.machine_id+"】监控点："+e.name,n.title.text+="-"+e.id,0<a.str_count){for(var o=0,s=0;s<a.str_count;s++)o+=a.str_list[s].value;n.title.subtext="统计时间："+i.date_time_cur+"(总访问次数:"+o+", 部分地理位置不能识别的访问将不显示在地图上) \n",n.visualMap.max=a.str_list[0].value+100,n.series[0].data=a.str_list}else n.series[0].data=[],n.title.subtextStyle.color="red",n.title.subtextStyle.fontWeight="bold",n.title.subtext="暂无数据上报";g_all_charts[t]=echarts.init(document.getElementById(t)),g_all_charts[t].setOption(n),g_all_charts[t].setwidth=g_dmtChartWidth}function dmtSetStrAttrInfoChart(t,e,a,i,r){var n={title:{x:"left",subtext:"",top:"top",subtextStyle:{},show:!0,text:""},tooltip:{trigger:"item",confine:!0,formatter:"上报字符串：{b}<br>上报值: {c} ({d}%)"},legend:{type:"scroll",orient:"vertical",right:"right",top:"70",show:!0},series:[{type:"pie",radius:"55%",center:["40%","55%"],data:[],label:{show:!0,emphasis:{show:!0}},itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]};$("#"+t).css("height",g_dmtChartHeight),n.title.text="view"==r?"视图ID【"+i.view_id+"】字符串型监控点："+e.name:"服务器ID【"+i.machine_id+"】字符串型监控点："+e.name,0<a.str_count?(n.title.subtext="统计时间："+i.date_time_cur+", 显示排名前 20 个",n.series[0].data=a.str_list):(n.series[0].data=[],n.title.subtextStyle.color="red",n.title.subtextStyle.fontWeight="bold",n.title.subtext="暂无数据上报",n.title.x="center",n.title.top="20%"),g_all_charts[t]=echarts.init(document.getElementById(t)),g_all_charts[t].setOption(n),g_all_charts[t].setwidth=g_dmtChartWidth}function dmtGetXAxisTimeInfo(t,e){for(var a=[],i=0;i<1440*e;i++)a.push(t+60*i*1e3);return a}function dmtGetYAxisData(t,e){for(var a=[],i=e.split(","),r=0;r<i.length;r++){var n=new Object;"null"!=i[r]?n.value=new Array(t[r],i[r]):n.value=[t[r],0],a.push(n)}return a}function dmtGetUsePerPieOption(t){var e=$.extend({c_items:1,c_sublink:""},t),a="blue",i="#044";4<e.c_colors.length&&(a=e.c_colors[4]),1<e.c_items&&(i="blue");var r={title:{id:e.c_name,text:e.c_text,triggerEvent:!0,subtext:e.c_subtext,left:"center",top:"center",textStyle:{color:i,fontSize:14,fontFamily:"PingFangSC-Regular"},subtextStyle:{color:a,fontSize:1<e.c_items?14:18,fontFamily:"PingFangSC-Regular",fontWeight:"bold",top:"center"},itemGap:-1},series:[{name:e.c_name,type:"pie",clockWise:!0,radius:["80%","95%"],itemStyle:{normal:{label:{show:!1},labelLine:{show:!1}}},hoverAnimation:!1,data:[{value:e.c_val,name:"completed",itemStyle:{normal:{borderWidth:8,borderColor:{colorStops:[{offset:0,color:e.c_colors[0]||e.c_colors[1]},{offset:1,color:e.c_colors[2]||e.c_colors[3]}]},color:{colorStops:[{offset:0,color:e.c_colors[0]||e.c_colors[1]},{offset:1,color:e.c_colors[2]||e.c_colors[3]}]},label:{show:!1},labelLine:{show:!1}}}},{name:"gap",value:100-e.c_val,itemStyle:{normal:{label:{show:!1},labelLine:{show:!1},color:"rgba(0, 0, 0, 0)",borderColor:"rgba(0, 0, 0, 0)",borderWidth:0}}}]}]};return""!=e.c_sublink&&(r.title.sublink=e.c_sublink,r.title.subtarget="self"),r}function dmtShowAttrInfo(t,e,a,i){var r,n={legend:{show:!1,bottom:10},title:{text:"",x:"center",subtext:"",top:"top",subtextStyle:{},show:!0},useUTC:!0,toolbox:{show:!0,orient:"vertical",top:"center",right:20,feature:{myUnMaskWarningData:{show:!0,title:"取消屏蔽告警",icon:"image://"+g_siteInfo.doc_path+"images/phone_sound.png",onclick:function(){}},myMaskWarningData:{show:!0,title:"屏蔽告警",icon:"image://"+g_siteInfo.doc_path+"images/phone_delete.png",onclick:function(){}},mySetWarningData:{show:!0,title:"设置告警",icon:"image://"+g_siteInfo.doc_path+"images/phone_edit.png",onclick:function(){}},myShowSingleData:{show:!0,title:"单独显示图表数据",icon:"image://"+g_siteInfo.doc_path+"images/arrow_out_longer.png",onclick:function(){}},restore:{show:!0,title:"还原图表显示"},dataZoom:{show:!0,xAxisIndex:0,yAxisIndex:!1},saveAsImage:{show:!0}}},grid:{tooltip:{show:!0,trigger:"axis"},top:70,bottom:50},xAxis:{show:!0,type:"time"},yAxis:{splitArea:{show:!0},show:!0,axisLabel:{formatter:function(t,e){return 1073741824<=t?(t/1073741824).toFixed(2)+"G":1048576<=t?(t/1048576).toFixed(2)+"M":1024<=t?(t/1024).toFixed(2)+"K":t}},type:"value"},series:[{name:"",showSymbol:!1,cursor:"pointer",type:"line",data:[]},{name:"",showSymbol:!1,cursor:"pointer",type:"line",data:[]},{name:"",showSymbol:!1,cursor:"pointer",type:"line",data:[]}]},o=e.list;if(void 0!==o){"view"==i?r=e.view_id:"machine"==i&&(r=e.machine_id);var s=1e3*e.date_time_start_utc-60*(new Date).getTimezoneOffset()*1e3,l=1;void 0!==e.date_time_monday&&(l=7);var d=dmtGetXAxisTimeInfo(s,l);1==e.type&&(n.legend.show=!0,n.grid.bottom=80);for(var _=!0,c=0;c<o.length;c++){var g="attr_"+o[c].id+"_"+r+i;0<$("#"+g).length&&(dmtJsBugReport("dmt.comm.js","dmtShowAttrInfo","bug:"+g),$("#"+g).html(""));var u='<div style="width:'+g_dmtChartWidth+"px; ";u+=" height:"+g_dmtChartHeight+"px; ",u+=" border:2px solid #335cad; padding-top:5px;",u+=" float:left; margin:"+g_dmtChartMargin+'px;" ',u+=' type="'+i+'" ',u+=' id="'+g+'" ',u+=' type_id="'+r+'" >',u+="</div>",$(a).append($(u));var m,h=t.list[c];h.id!=o[c].id&&(h=dmtGetAttrInfo(t,o[c].id)),void 0!==g_all_charts[g]&&g_all_charts[g].dispose(),7!=h.data_type?6!=h.data_type?(_=void 0!==o[c].value_list_str&&0<o[c].max?(n.series[0].data=dmtGetYAxisData(d,o[c].value_list_str),!0):!(n.series[0].data=[]),1==e.type&&(n.series[0].name="今日 ["+e.date_time_cur+"]","0"!=o[c].value_list_yst_str?n.series[1].data=dmtGetYAxisData(d,o[c].value_list_yst_str):n.series[1].data=[],n.series[1].name="昨日 ["+e.date_time_yst+"]","0"!=o[c].value_list_lwk_str?n.series[2].data=dmtGetYAxisData(d,o[c].value_list_lwk_str):n.series[2].data=[],n.series[2].name="上周同日 ["+e.date_time_wkd+"]","0"==o[c].value_list_yst_str&&"0"==o[c].value_list_lwk_str||(_=!0)),5==h.data_type?n.yAxis.min=o[c].min:n.yAxis.min=0,e.show_single_type=e.type,n.title.text=dmtGetViewTitle(i,e,h),m=new Object,n.title.subtext=dmtGetViewSubTitle(i,e,o[c],h),dmtSetCustToolBox(n,i,e,o[c],h,m),_?(n.title.subtextStyle.color="gray",n.title.top="top",n.xAxis.show=!0,n.yAxis.show=!0,n.toolbox.feature.dataZoom.show=!0,n.toolbox.feature.myShowSingleData.show=!0):(n.title.subtextStyle.color="red",n.title.top="20%",n.xAxis.show=!1,n.yAxis.show=!1,n.toolbox.feature.dataZoom.show=!1,n.toolbox.feature.myShowSingleData.show=!1),g_all_charts[g]=echarts.init(document.getElementById(g)),g_all_charts[g].setOption(n),g_all_charts[g].warnInfo=m,g_all_charts[g].setwidth=g_dmtChartWidth):dmtSetStrAttrInfoChart(g,h,o[c],e,i):dmtSetStrAttrInfoChartIpGeo(g,h,o[c],e,i)}}}function dmtGetSyssetTypeHtml(t){var e="<label>服务器类型：</label>";return e+='<select name="',e+=t+'" id="',e+=t+'">" ',e+='<option value="0">请选择</option>',e+='<option value="1">日志服务器</option>',e+='<option value="2">监控点服务器</option>',e+='<option value="3">mysql 监控点服务器</option>',e+='<option value="4">中心服务器</option>',e+='<option value="11">web 服务器</option>',g_html_systype=e+="</select>",g_html_systype}function dmtGetServerTypeName(t){switch(t){case 1:return"日志服务器";case 2:return"监控点服务器";case 3:return"mysql 监控点服务器";case 4:return"中心服务器";case 11:return"web 服务器";default:return"未知类型"}}function dmtTriggerLeftMenu(){1!=DWZ.ui.sbar?0!=DWZ.ui.sbar||$("#sidebar_s .toggleCollapse div").trigger("click"):$("#sidebar .toggleCollapse div").trigger("click")}function dmtLv2CheckCodeDlgClose(){return"undefined"!=typeof g_dclc_TimerId&&null!=g_dclc_TimerId&&(clearTimeout(g_dclc_TimerId),g_dclc_TimerId=null),!0}function dmtPopDaemonTipMsg(){void 0!==$.pdialog._current&&null!=$.pdialog._current&&$.pdialog.closeCurrent();$.pdialog.openLocal("dct_dlg_show_daemon_tip_msg","dct_dlg_show_daemon_tip_msg","演示版操作提示",{mask:!0,maxable:!1,height:280,width:410,resizable:!1,drawable:!0})}function dmtFirstDealAjaxResponse(t){if(void 0===t)return!1;if(null==t||"null"==t||void 0===t.ec)return!1;if(666==t.ec)return dmtPopDaemonTipMsg(),!0;if(111==t.ec)return navTab.closeCurrentTab(),void 0!==$.pdialog._current&&null!=$.pdialog._current&&$.pdialog.closeCurrent(),location=t.redirect_url,!0;if(300==t.ec||1<=t.ec&&t.ec<200){var e="服务器返回错误，错误码：";return e+=t.ec,void 0!==t.msg?(e+="，错误消息：",e+=t.msg):void 0!==t.msgid&&(e+="，错误消息：",e+=DWZ.msg(json.msgid)),alertMsg.warn(e),!0}return!1}function dmtGetHumanReadDigitByKB(t){var e,a="";return 1048576<=t?(e=t/1048576,a=Math.round(100*parseFloat(e))/100+" GB"):1024<=t?(e=t/1024,a=Math.round(100*parseFloat(e))/100+" MB"):void 0!==t&&(a=t+" KB"),a}function dmt_duc_dlg_modify_name_close(){return"undefined"!=typeof g_dci_TimerId&&null!=g_dci_TimerId&&(clearTimeout(g_dci_TimerId),g_dci_TimerId=null),!0}function dmtGetFastWebIdx(){if("undefined"==typeof r_siteInfo)return 0;r_siteInfo.web_fast_ms=864e5,r_siteInfo.web_slow_ms=0;for(var t,e=r_siteInfo.web_list,a=e.length,i=0;i<e.length;i++){void 0!==e[i].end&&((t=e[i].end.getTime()-e[i].start.getTime())>r_siteInfo.web_slow_ms&&(r_siteInfo.web_slow_ms=t),t<r_siteInfo.web_fast_ms&&(r_siteInfo.web_fast_ms=t,a=i))}return a}function dmtTestWebSvr(){if("undefined"==typeof r_siteInfo)return 0;for(var t=0;t<r_siteInfo.web_list.length;t++){r_siteInfo.web_list[t].start=new Date;var e="http://"+r_siteInfo.web_list[t].ip+"/cgi-bin/slog_flogin?action=check_web_speed";e+="&check_idx="+t,$.ajax({url:e,cache:!1,success:function(t){0<=t.check_idx&&t.check_idx<r_siteInfo.web_list.length&&(r_siteInfo.web_list[t.check_idx].end=new Date)},dataType:"json"})}}function dmtGetBytesLength(t){for(var e=0,a=0,i=t.length;a<i;a++)charCode=t.charCodeAt(a),charCode<=127?e+=1:charCode<=2047?e+=2:charCode<=65535?e+=3:e+=4;return e}function redrawChartsOnSwitchTab(){var t,e,a,i=navTab.getCurrentTabId();if(null!=i){if(i.match("showmachine_"))e="machine",t=i.split("_")[1],a="none"!=$("#dsmLeftMenu_"+t).css("display");else if(i.match("innersite_"))e="site",t=i.split("_")[1],a="none"!=$("#dsLeftMenu_"+t).css("display");else{if(!i.match("showview_"))return;e="view",t=i.split("_")[1],a="none"!=$("#dsLeftMenu_"+t).css("display")}dmtSetRedrawChartsInfo(t,e,a),dmtRedrawCharts()}}function redrawChartsMain(){$("#navMenuLast").hasClass("selected")&&(dcMainPageSetChartSize(),dcMainPageRedrawChart())}function redrawCharts(){var t=navTab.getCurrentTabId();null!=t?((t.match("showmachine_")||t.match("showview_")||t.match("innersite_"))&&dmtRedrawCharts(),t.match("dmt_plugin_")&&dmtSetPluginMarginInfo(t)):dcOnMainPage("main")}